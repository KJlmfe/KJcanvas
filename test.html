<html>
	<head>
		<script src="ThirdLibrary/jquery-1.7.2.min.js"></script>
		<script src="Animation/rectangle.js"></script>
	</head>

	<body onload="init();">
		<h3 id="AlgorithmName">
		</h3>
		<div id="AlgorithmControlBar">
		</div>
		<canvas id="canvas" width="960" height="600" style="border:1px solid #000000;"></canvas>
		
	<script type="text/javascript">
		var Mycanvas= document.getElementById("canvas");
		var ctx = Mycanvas.getContext("2d");
		
		var canvas = new canvas(Mycanvas.width,Mycanvas.height);
		var speed = 1; //全局动画速度百分比 1 = normal速度的百分之百
		var SHAPE_WIDTH = 30;
		var SHAPE_HEIGHT = 30;
		var START_X = 30;
		var START_Y = 30;
		var END_X = 300;
		var END_Y = 500;
		var MOVE_SPEED = 5;
		var DELAY_TIME = 1000;
		var ALGORITHM_NAME = "堆栈(数组)";	
	
		Stack = function(size)
		{
		
		}
		Stack.prototype.create = function(stackSize)
		{
			this.stack = new Array();
			this.size = 10;
			this.top = 0;
			if(stackSize)
				this.size = stackSize;
		}
		function init()
		{
			var SimpleStack = new Stack();
			SimpleStack.addControls(SimpleStack);
		}
		Stack.prototype.addControls = function(obj)
		{
			$("#AlgorithmName").html(ALGORITHM_NAME);
			this.TextInput = addAlgorithmControlBar("text","");
			this.CreatStackButton = addAlgorithmControlBar("button","Creat Stack");
			this.CreatStackButton.onclick = function(){
				var stackSize = obj.TextInput.value;
				obj.create(stackSize);
				obj.TextInput.value = "";
				obj.PushButton.disabled = false;
			}

			this.PushButton = addAlgorithmControlBar("button","Push");
			this.PushButton.onclick = function(){
				var value = obj.TextInput.value;
				obj.push(value);	
				obj.TextInput.value = "";
			}

			this.PopButton = addAlgorithmControlBar("button","Pop");
			this.PopButton.onclick = function(){
				obj.pop();
			}

			this.PushButton.disabled = true;
			this.PopButton.disabled = true;
		}
		Stack.prototype.push = function( value )
		{
			this.stack[this.top] = new Rectangle(SHAPE_WIDTH,SHAPE_HEIGHT,START_X,START_Y,value);
			$(".controler").attr("disabled","disabled");
			canvas.cmd("Setup");	
		 	canvas.cmd("Draw",this.stack[this.top],START_X,START_Y);
		 	canvas.cmd("Delay",DELAY_TIME);
		
			if(this.top == 0)
		 		waitTime = canvas.cmd("Move",this.stack[this.top],END_X,END_Y,MOVE_SPEED);
		 	else
		 		waitTime = canvas.cmd("Move",this.stack[this.top],this.stack[this.top-1].x,this.stack[this.top-1].y-SHAPE_WIDTH,MOVE_SPEED);
			var me = this; 
			setTimeout(function(){
				me.top++
				$(".controler").removeAttr("disabled");
			},waitTime);		
		}
		Stack.prototype.pop = function()
		{
			var me = this;
		 	this.top--;
			$(".controler").attr("disabled","disabled");

			canvas.cmd("Setup");
		    canvas.cmd("Move",this.stack[this.top],START_X,START_Y,MOVE_SPEED);
			canvas.cmd("Delay",DELAY_TIME);
			waitTime = canvas.cmd("Delete",this.stack[this.top]);
			setTimeout(function(){
				$(".controler").removeAttr("disabled");
				if(me.top <= 0)
					me.PopButton.disabled = true;
			},waitTime);		
		}
	</script>

	</body>
</html>
